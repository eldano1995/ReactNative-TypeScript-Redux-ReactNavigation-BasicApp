name: release-apk-android
on: 
  push:
    branches: 
      - master
        
jobs:
  release-apk-android:
    runs-on: ubuntu-18.04
    name: Release Android apk
    
    strategy:
      matrix:
        node-version: [12.x]
    
    steps:
#       - name: React Native Android Build APK
#         uses: realabbas/Github-Actions-React-Native@v1.1.2
      - name: Checkout last commit
        uses: actions/checkout@v2.3.2
        
      - name: Setup NodeJS version ${{ matrix.node_version }}
        uses: actions/setup-node@v2.1.0
        with:
          node-version: ${{ matrix.node_version }}
      
      - name: Run npm install
        run: sudo npm install
      
      - name: Get linux permissions for running gradlew
#         run: cd android && chmod +x ./gradlew
        run: sudo chmod -R 777 ./android
        
      - name: Build apk
        run: cd android && sudo ./gradlew assembleRelease
      
      - name: Get linux permissions for running gradlew for second time
        run: sudo chmod -R 777 ./android
        
      - name: List files in dir
        run: |          
          cd android
          echo "-------> android folder"
          ls
          
          cd build
          echo "-------> build"
          ls
          
          cd outputs
          echo "-------> outputs"
          ls
          
          cd apk
          echo "-------> apk"
          ls
          
      
      - name: Upload app file
        uses: actions/upload-artifact@v2.1.0
        with:
          name: android-release
          path: android/build/outputs/apk/release/



# This workflow uses actions that are not certified by GitHub.
# They are provided by a third-party and are governed by
# separate terms of service, privacy policy, and support
# documentation.

# This workflow will install Deno and run tests across stable and nightly builds on Windows, Ubuntu and macOS.
# For more information see: https://github.com/denolib/setup-deno

# name: Deno

# on:
#   push:
#     branches: [master]
#   pull_request:
#     branches: [master]

# jobs:
#   test:
#     runs-on: ${{ matrix.os }} # runs a test on Ubuntu, Windows and macOS

#     strategy:
#       matrix:
#         deno: ["v1.x", "nightly"]
#         os: [macOS-latest, windows-latest, ubuntu-latest]

#     steps:
#       - name: Setup repo
#         uses: actions/checkout@v2

#       - name: Setup Deno
#         uses: denolib/setup-deno@c7d7968ad4a59c159a777f79adddad6872ee8d96
#         with:
#           deno-version: ${{ matrix.deno }} # tests across multiple Deno versions

#       - name: Cache Dependencies
#         run: deno cache deps.ts

#       - name: Run Tests
#         run: deno test -A --unstable
